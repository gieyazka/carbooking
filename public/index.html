<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/logo.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1 ,maximum-scale=1.0 ,user-scalable=0" />
  <meta name="theme-color" content="#000000" />
  
  <!-- <meta name="description" content="Web site created using create-react-app" /> -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Bai+Jamjuree:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
    rel="stylesheet">
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo.svg" />

  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  <script src="https://www.gstatic.com/firebasejs/7.16.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.16.1/firebase-messaging.js"></script>
  <!-- <script src="/firebase-messaging.js"></script> -->
<!-- Cookie Consent by https://www.cookiewow.com -->
<script type="text/javascript" src="https://script.cookiewow.com/cwc.js"></script>
<script id="cookieWow" type="text/javascript" src="https://script.cookiewow.com/configs/N4TZqrjbAsnoKSd4twPsHP3i" data-cwcid="N4TZqrjbAsnoKSd4twPsHP3i"></script>
  <title>Car Booking</title>
  <style>


.hidden {
  display: none !important;
}

#installContainer {
  position: absolute;
  bottom: 1em;
  display: flex;
  justify-content: center;
  width: 100%;
}

#installContainer button {
  background-color: inherit;
  border: 1px solid white;
  color: white;
  font-size: 1em;
  padding: 0.75em;
}
  </style>
</head>

<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>  
  <!-- Install button, hidden by default -->
  <div id="installContainer" class="hidden">
    <button id="butInstall" type="button">
      Install
    </button>
  </div>
  <div id="root"></div>

</body>

</html>
<script> 
const divInstall = document.getElementById('installContainer');
const butInstall = document.getElementById('butInstall');

/* Put code here */
window.addEventListener('beforeinstallprompt', (event) => {
  console.log('üëç', 'beforeinstallprompt', event);
  // Stash the event so it can be triggered later.
  window.deferredPrompt = event;
  // Remove the 'hidden' class from the install button container
  divInstall.classList.toggle('hidden', false);
});



butInstall.addEventListener('click', async () => {
  console.log('üëç', 'butInstall-clicked');
  const promptEvent = window.deferredPrompt;
  if (!promptEvent) {
    // The deferred prompt isn't available.
    return;
  }
  // Show the install prompt.
  promptEvent.prompt();
  // Log the result
  const result = await promptEvent.userChoice;
  console.log('üëç', 'userChoice', result);
  // Reset the deferred prompt variable, since
  // prompt() can only be called once.
  window.deferredPrompt = null;
  // Hide the install button.
  divInstall.classList.toggle('hidden', true);
});


window.addEventListener('appinstalled', (event) => {
  console.log('üëç', 'appinstalled', event);
  // Clear the deferredPrompt so it can be garbage collected
  window.deferredPrompt = null;
});
</script>
<script>
  var config = {
    'messagingSenderId': '851373916828',
    'apiKey': 'AIzaSyCX9MgSHZd64fwVG7I7QriHcfyLzryob08',
    'projectId': 'car-booking-4433a',
    'appId': '1:851373916828:web:bdb3c4099248049c946359',
  };
  firebase.initializeApp(config);

  const messaging = firebase.messaging();

  if ('serviceWorker' in navigator) {

    

    navigator.serviceWorker.register('/carbooking/firebase-messaging-sw.js')
      .then(function (reg) {
        messaging.useServiceWorker(reg);
        messaging
          .requestPermission()
          .then(function () {
            // get the token in the form of promise
            return messaging.getToken()
          })
          .then(function (token) {
            localStorage.setItem('carbookingKey', token);
          })
          .catch(function (err) {
            console.log("Unable to get permission to notify.", err);
          });
        if (reg.installing) {
          console.log('SW installing');
        } else if (reg.waiting) {
          console.log('SW waiting');
        } else if (reg.active) {
          console.log('SW activated');
        }
      }).catch(function (error) {
        // registration failed
        console.log('Registration failed with ' + error);
      });
  } 



  let enableForegroundNotification = true;
  messaging.onMessage(function (payload) {
    if (enableForegroundNotification) {
      const { title, ...options } = JSON.parse(payload.data.notification);
      navigator.serviceWorker.getRegistrations().then(registration => {
        registration[0].showNotification(title, options);
      });
    } 
  });
</script>